<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flappy Bird Clone</title>
  <style>
    /* no scrollbars, fill parent */
    html, body {
      margin: 0; padding: 0;
      width: 100%; height: 100%;
      overflow: hidden; background: #70c5ce;
      position: relative;
    }
    /* responsive canvas */
    #canvas {
      display: block; width:100%; height:100%;
      image-rendering: pixelated;
    }
    /* fullscreen button */
    #fullscreenBtn {
      position:absolute; top:10px; right:10px;
      z-index:1; padding:6px 10px; font-size:14px;
      background:rgba(0,0,0,0.5); color:#fff;
      border:none; border-radius:4px; cursor:pointer;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }
  </style>
</head>
<body>
  <button id="fullscreenBtn">Full Screen</button>
  <canvas id="canvas" width="320" height="480"></canvas>

  <!-- Load game logic (defines window.requestGameFullscreen) -->
  <script src="game.js?v=3"></script>

  <script>
    // Notify parent that embed is loaded (best-effort)
    try { window.parent.postMessage("EMBED_READY","*"); } catch(e) {}

    // Wire the fullscreen button directly to the helper (gesture-safe)
    (function () {
      const btn = document.getElementById('fullscreenBtn');
      const canvas = document.getElementById('canvas');
      if (!btn) return;

      btn.addEventListener('click', function (e) {
        e.preventDefault();
        const target = (canvas && canvas.parentNode) || document.documentElement;

        if (typeof window.requestGameFullscreen === 'function') {
          // Synchronous helper call â€” tries FS, falls back by posting to parent on iOS
          window.requestGameFullscreen(target);
        } else {
          // If helper not ready, immediately ask parent for fallback
          try { window.parent.postMessage({ cmd: 'openFullscreenFlappy' }, '*'); } catch(e){}
        }
      }, { passive: false });
    })();
  </script>
</body>
</html>
